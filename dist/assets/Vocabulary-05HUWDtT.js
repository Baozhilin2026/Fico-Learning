import{J as he,n as c,K as R,L as ae,d as oe,g as s,c as f,a as e,t as p,e as n,b as r,M as ve,N as ce,O as ke,y as Ce,r as A,o as me,P as pe,w as m,i as we,f as $e,m as S,Q as fe,R as Se,k as F,S as se,F as Y,C as Z,T as re,G as de,j as O,U as Ve,V as Be,W as Me,X as xe}from"./index-SAl2EyZQ.js";import{u as ze}from"./bookmarks-DUl0TpL9.js";import{u as _e,B as Ae}from"./BottomInfoBar-Duo3HV6b.js";import{_ as le,u as ye}from"./_plugin-vue_export-helper-Cve9Aa48.js";import{u as ge,T as Pe}from"./useTTS-KGTHt4_d.js";import{V as Te}from"./VocabularyCard-C09RpuAE.js";import"./logo-Cq9nXPts.js";const Ge=he("vocabulary",()=>{const C=c([]),b=c("åŸºæœ¬æ¦‚å¿µ"),z=c(!1),I=c(null),y=c([]),d=R(()=>ae.getVocabulariesBySection(b.value)),P=R(()=>C.value.length);async function T(){if(!(C.value.length>0)){z.value=!0,I.value=null;try{await ae.loadVocabularies(),y.value=ae.getSectionNames(),y.value.forEach(u=>{ae.getVocabulariesBySection(u).forEach(B=>{C.value.push({...B,ç« èŠ‚:u})})})}catch(u){I.value=u instanceof Error?u.message:"Failed to load vocabularies",console.error("Failed to load vocabularies:",u)}finally{z.value=!1}}}function V(u){b.value=u}function g(u){return C.value.find(h=>h.åºå·===u)}function N(u){return ae.searchVocabularies(u)}function w(u){return u.length===0?C.value:C.value.filter(h=>u.includes(h.ç« èŠ‚))}return{vocabularies:C,currentSection:b,loading:z,error:I,sections:y,currentVocabularies:d,totalCount:P,loadVocabularies:T,setSection:V,getVocabularyById:g,searchVocabularies:N,getVocabulariesBySectionNames:w}}),Ie={class:"vocabulary-list-item"},Ne={class:"item-content"},qe={class:"term-section"},De={class:"english-term"},Le={class:"ipa-pronunciation"},Ue={class:"ipa"},je={class:"translation-section"},Ee={class:"chinese-translation"},Re=oe({__name:"VocabularyListItem",props:{vocabulary:{},isBookmarked:{type:Boolean,default:!1}},emits:["bookmark"],setup(C){const b=C,{speak:z,isPlaying:I}=ge(),y=c(!1),d=_e();async function P(){y.value=!0;try{await z(b.vocabulary.è‹±æ–‡,{accent:"western",gender:"female",rate:1}),d.addRecord({type:"vocabulary",title:`${b.vocabulary.è‹±æ–‡} - ${b.vocabulary.ä¸­æ–‡ç¿»è¯‘}`})}finally{y.value=!1}}return(T,V)=>{const g=A("el-button");return s(),f("div",Ie,[e("div",Ne,[e("div",qe,[e("h3",De,p(C.vocabulary.è‹±æ–‡),1),e("div",Le,[e("span",Ue,p(C.vocabulary.è¯»éŸ³),1),n(g,{icon:r(I)?r(ve):r(ce),circle:"",size:"small",loading:y.value,onClick:P},null,8,["icon","loading"])])]),e("div",je,[e("span",Ee,p(C.vocabulary.ä¸­æ–‡ç¿»è¯‘),1)])]),n(g,{icon:C.isBookmarked?r(ke):r(Ce),type:C.isBookmarked?"warning":"default",circle:"",size:"small",onClick:V[0]||(V[0]=N=>T.$emit("bookmark",C.vocabulary))},null,8,["icon","type"])])}}}),Fe=le(Re,[["__scopeId","data-v-fd4df816"]]),Ke={class:"dictation-practice"},Oe={class:"practice-header"},Qe={key:0,class:"countdown-overlay"},We={class:"countdown-content"},Je={class:"countdown-number"},Xe={key:1,class:"practice-content"},He={class:"audio-section"},Ye={class:"audio-controls"},Ze={class:"input-section"},et={key:2,class:"result-content"},tt={key:0,class:"celebration"},at={key:1,class:"your-answer"},ot={class:"practice-footer"},lt=oe({__name:"DictationPractice",props:{vocabularies:{}},emits:["complete"],setup(C,{emit:b}){const z=C,I=b,{t:y}=ye(),{speak:d,isPlaying:P,stop:T}=ge(),V=c(0),g=c(""),N=c(!1),w=c(!1),u=c(0),h=c([]),B=c(3),L=c(!0),x=c(null),D=R(()=>Math.min(10,z.vocabularies.length)),ee=R(()=>V.value/D.value*100),q=R(()=>{if(h.value.length===0)return z.vocabularies[0];const $=h.value[V.value];return z.vocabularies[$]});function Q(){L.value=!0,B.value=3,x.value=window.setInterval(()=>{B.value--,B.value<=0&&(x.value&&(clearInterval(x.value),x.value=null),L.value=!1,d(q.value.è‹±æ–‡,{accent:"western",gender:"female",rate:1}))},1e3)}me(()=>{const $=Array.from({length:z.vocabularies.length},(l,j)=>j);te($),h.value=$.slice(0,D.value),Q()});function te($){for(let l=$.length-1;l>0;l--){const j=Math.floor(Math.random()*(l+1));[$[l],$[j]]=[$[j],$[l]]}}async function W(){P.value?T():await d(q.value.è‹±æ–‡,{accent:"western",gender:"female",rate:1})}function J(){T(),setTimeout(()=>{d(q.value.è‹±æ–‡,{accent:"western",gender:"female",rate:1})},100)}function U(){const $=q.value.è‹±æ–‡.toLowerCase().trim(),l=g.value.toLowerCase().trim();w.value=$===l,w.value&&u.value++,N.value=!0}function M(){g.value="",N.value=!1,d(q.value.è‹±æ–‡,{accent:"western",gender:"female",rate:1})}function v(){g.value="",N.value=!1,V.value>=D.value-1?I("complete",{correct:u.value,total:D.value}):(V.value++,d(q.value.è‹±æ–‡,{accent:"western",gender:"female",rate:1}))}return pe(()=>{x.value&&clearInterval(x.value)}),($,l)=>{const j=A("el-tag"),E=A("el-button"),X=A("el-button-group"),K=A("el-input"),a=A("el-space"),t=A("el-result"),o=A("el-progress");return s(),f("div",Ke,[e("div",Oe,[l[1]||(l[1]=e("h3",null,"å¬åŠ›é»˜å†™ç»ƒä¹ ",-1)),n(j,null,{default:m(()=>[S(p(V.value+1)+" / "+p(D.value),1)]),_:1})]),L.value?(s(),f("div",Qe,[e("div",We,[e("div",Je,p(B.value),1),l[2]||(l[2]=e("div",{class:"countdown-text"},"ç§’åå¼€å§‹æ’­æ”¾",-1))])])):N.value?(s(),f("div",et,[n(t,{icon:w.value?"success":"error",title:w.value?r(y)("vocabulary.correct"):r(y)("vocabulary.incorrect")},{"sub-title":m(()=>[e("div",{class:se(["answer-comparison",{"correct-answer":w.value}])},[w.value?(s(),f("div",tt,[...l[6]||(l[6]=[e("div",{class:"confetti"},"ğŸ‰",-1),e("div",{class:"encouragement-text"},"å¤ªæ£’äº†ï¼",-1)])])):F("",!0),e("p",null,[e("strong",null,p(r(y)("vocabulary.correctAnswer"))+":",1),S(" "+p(q.value.è‹±æ–‡),1)]),e("p",null,[l[7]||(l[7]=e("strong",null,"ä¸­æ–‡ç¿»è¯‘:",-1)),S(" "+p(q.value.ä¸­æ–‡ç¿»è¯‘),1)]),w.value?F("",!0):(s(),f("p",at,[e("strong",null,p(r(y)("vocabulary.yourAnswer"))+":",1),S(" "+p(g.value),1)]))],2)]),extra:m(()=>[n(a,null,{default:m(()=>[n(E,{onClick:M},{default:m(()=>[...l[8]||(l[8]=[S("é‡è¯•",-1)])]),_:1}),n(E,{type:"primary",onClick:v},{default:m(()=>[...l[9]||(l[9]=[S("ç»§ç»­",-1)])]),_:1})]),_:1})]),_:1},8,["icon","title"])])):(s(),f("div",Xe,[e("div",He,[n(E,{type:"primary",icon:r(P)?r(ve):r(ce),circle:"",size:60,onClick:W},null,8,["icon"]),e("div",Ye,[n(X,null,{default:m(()=>[n(E,{icon:r(fe),onClick:J},{default:m(()=>[...l[3]||(l[3]=[S(" é‡æ–°æ’­æ”¾ ",-1)])]),_:1},8,["icon"]),n(E,{icon:r(Se),onClick:v},{default:m(()=>[...l[4]||(l[4]=[S(" è·³è¿‡ ",-1)])]),_:1},8,["icon"])]),_:1})])]),e("div",Ze,[n(K,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=_=>g.value=_),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥ä½ å¬åˆ°çš„è‹±æ–‡æœ¯è¯­...",onKeyup:we($e(U,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"]),n(E,{type:"primary",size:"large",disabled:!g.value.trim(),onClick:U},{default:m(()=>[...l[5]||(l[5]=[S(" æäº¤ç­”æ¡ˆ (Ctrl+Enter) ",-1)])]),_:1},8,["disabled"])])])),e("div",ot,[n(o,{percentage:ee.value},null,8,["percentage"])])])}}}),nt=le(lt,[["__scopeId","data-v-ed104679"]]),st={class:"match3-game"},ct={key:0,class:"start-screen"},ut={class:"start-content"},it={key:1,class:"game-board-screen"},rt={class:"board-container"},dt=["onClick"],vt={key:0,class:"card-text"},mt={key:1,class:"card-text"},pt={key:0,class:"combo-display"},ft={class:"combo-text"},_t={key:2,class:"level-complete-screen"},yt={style:{position:"absolute",top:"10px",left:"10px",background:"yellow",color:"black",padding:"10px","z-index":"9999"}},gt={class:"celebration-container"},bt={class:"celebration-animation"},ht={class:"sparkles"},kt={class:"level-complete-content"},Ct={class:"complete-stats"},wt={class:"stat-item"},$t={class:"stat-value"},St={class:"stat-item"},Vt={class:"stat-value"},Bt={class:"stat-item"},Mt={class:"stat-value"},xt={class:"stat-item"},zt={class:"stat-value"},At={class:"complete-actions"},Pt=oe({__name:"Match3Game",props:{vocabularies:{}},emits:["close"],setup(C,{emit:b}){const z=C,I=b,y=c("start"),d=c(0),P=c(1),T=c(0),V=c(0),g=c(0),N=c(0),w=c(0),u=c([]),h=c([]),B=c(null),L=c(null),x=c(null),D={rows:5,cols:5};function ee(){return D}function q(){const t=[...z.vocabularies].sort(()=>Math.random()-.5).slice(0,10),o=[];let _=0;for(const k of t)o.push({vocab:k,id:_++,matched:!1,type:"english"}),o.push({vocab:k,id:_++,matched:!1,type:"chinese"}),u.value.find(G=>G.åºå·===k.åºå·)||u.value.push(k);const i=D.rows*D.cols;for(;o.length<i;)o.push(null);for(let k=o.length-1;k>0;k--){const G=Math.floor(Math.random()*(k+1));[o[k],o[G]]=[o[G],o[k]]}h.value=o,B.value=null}function Q(){y.value="playing",d.value=0,P.value=1,T.value=0,V.value=0,g.value=0,N.value=0,w.value=0,u.value=[],q(),J(),K("start")}function te(){U(),Q()}function W(){U(),I("close")}function J(){L.value=window.setInterval(()=>{V.value++},1e3)}function U(){L.value&&(clearInterval(L.value),L.value=null)}function M(a){const t=Math.floor(a/60),o=a%60;return`${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}async function v(a){if(y.value!=="playing")return;const t=h.value[a];!t||t.matched||(K("click"),B.value===null?B.value=a:B.value===a?B.value=null:await $(B.value,a))}async function $(a,t){const o=h.value[a],_=h.value[t];if(!o||!_)return;if(T.value++,o.vocab.åºå·===_.vocab.åºå·){K("match"),o.matched=!0,_.matched=!0,d.value+=10,w.value++;const k=o.vocab;u.value.find(G=>G.åºå·===k.åºå·)||u.value.push(k),B.value=null,await l(a,t),await X()}else B.value=t}async function l(a,t){const o=h.value[a].vocab.åºå·,_=await j(a,t,o);_.length>=3&&await E([..._,a,t])}async function j(a,t,o){const _=ee(),i=new Set,k=[a,t];for(i.add(a),i.add(t);k.length>0;){const G=k.shift(),ne=h.value[G];if(!ne||ne.matched||ne.vocab.åºå·!==o)continue;const ue=Math.floor(G/_.cols),ie=G%_.cols,be=[ue>0?G-_.cols:null,ue<_.rows-1?G+_.cols:null,ie>0?G-1:null,ie<_.cols-1?G+1:null].filter(H=>H!==null&&!i.has(H));for(const H of be)H!==null&&(k.push(H),i.add(H))}return Array.from(i)}async function E(a){for(const t of a){const o=h.value[t];o&&!o.matched&&(o.matched=!0,d.value+=5,w.value++)}g.value=a.length,g.value>N.value&&(N.value=g.value),await X()}async function X(){const a=h.value.filter(o=>o&&o.matched).length,t=h.value.filter(o=>o!==null).length;console.log("checkGameComplete:",{matchedCells:a,totalCards:t,gameState:y.value}),a===t&&t>0&&(console.log("Game complete! Setting state to levelComplete"),U(),K("levelUp"),y.value="levelComplete")}function K(a){try{x.value||(x.value=new(window.AudioContext||window.webkitAudioContext));const t=x.value.createOscillator(),o=x.value.createGain();t.connect(o),o.connect(x.value.destination);const i={click:{freq:800,duration:.1},match:{freq:523,duration:.2},levelUp:{freq:659,duration:.3},start:{freq:440,duration:.2}}[a];t.frequency.value=i.freq,o.gain.value=.3,t.start(x.value.currentTime),o.gain.exponentialRampToValueAtTime(.01,x.value.currentTime+i.duration),t.stop(x.value.currentTime+i.duration)}catch(t){console.warn("Sound play failed:",t)}}return pe(()=>{U()}),(a,t)=>{const o=A("el-icon"),_=A("el-button");return s(),f("div",st,[y.value==="start"?(s(),f("div",ct,[e("div",ut,[t[1]||(t[1]=e("h2",null,"æ¶ˆæ¶ˆä¹",-1)),t[2]||(t[2]=e("p",{class:"subtitle"},"ç‚¹å‡»ä¸¤å¼ ä¸­è‹±æ–‡å«ä¹‰ç›¸åŒçš„å¡ç‰‡è¿›è¡Œæ¶ˆé™¤åŒ¹é…",-1)),n(_,{type:"primary",size:"large",onClick:Q},{default:m(()=>[n(o,null,{default:m(()=>[n(r(ce))]),_:1}),t[0]||(t[0]=S(" å¼€å§‹æ¸¸æˆ ",-1))]),_:1})])])):y.value==="playing"?(s(),f("div",it,[e("div",rt,[(s(!0),f(Y,null,Z(h.value,(i,k)=>(s(),f("div",{key:i?i.id:`empty-${k}`,class:se(["game-cell",{empty:!i,selected:B.value===k,matched:i==null?void 0:i.matched}]),onClick:G=>v(k)},[i?(s(),f("div",{key:0,class:se(["cell-content",i.type])},[i.type==="english"?(s(),f("div",vt,p(i.vocab.è‹±æ–‡),1)):(s(),f("div",mt,p(i.vocab.ä¸­æ–‡ç¿»è¯‘),1))],2)):F("",!0)],10,dt))),128)),g.value>=3?(s(),f("div",pt,[e("div",ft,p(g.value)+" è¿æ¶ˆï¼",1)])):F("",!0)])])):y.value==="levelComplete"?(s(),f("div",_t,[e("div",yt," DEBUG: gameState = "+p(y.value),1),n(_,{class:"close-overlay-btn",icon:r(re),circle:"",onClick:W},null,8,["icon"]),e("div",gt,[e("div",bt,[(s(),f(Y,null,Z(50,i=>e("div",{class:"confetti",key:i,style:de({animationDelay:`${i*.03}s`})},null,4)),64)),t[3]||(t[3]=e("div",{class:"trophy-icon"},"ğŸ†",-1)),e("div",ht,[(s(),f(Y,null,Z(8,i=>e("div",{class:"sparkle",key:i,style:de({animationDelay:`${i*.2}s`})},null,4)),64))])]),e("div",kt,[t[10]||(t[10]=e("h2",{class:"complete-title"},"å¤ªæ£’äº†ï¼ğŸ‰",-1)),t[11]||(t[11]=e("p",{class:"complete-message"},"æ­å–œä½ å®Œæˆäº†æ‰€æœ‰å¡ç‰‡çš„æ¶ˆé™¤ï¼",-1)),e("div",Ct,[e("div",wt,[t[4]||(t[4]=e("div",{class:"stat-label"},"æœ€ç»ˆå¾—åˆ†",-1)),e("div",$t,p(d.value),1)]),e("div",St,[t[5]||(t[5]=e("div",{class:"stat-label"},"å®Œæˆå…³å¡",-1)),e("div",Vt,p(P.value),1)]),e("div",Bt,[t[6]||(t[6]=e("div",{class:"stat-label"},"æ¶ˆé™¤æ•°é‡",-1)),e("div",Mt,p(w.value),1)]),e("div",xt,[t[7]||(t[7]=e("div",{class:"stat-label"},"ç”¨æ—¶",-1)),e("div",zt,p(M(V.value)),1)])]),e("div",At,[n(_,{type:"primary",size:"large",onClick:te},{default:m(()=>[n(o,null,{default:m(()=>[n(r(fe))]),_:1}),t[8]||(t[8]=S(" å†æ¥ä¸€æ¬¡ ",-1))]),_:1}),n(_,{size:"large",onClick:W},{default:m(()=>[n(o,null,{default:m(()=>[n(r(re))]),_:1}),t[9]||(t[9]=S(" é€€å‡º ",-1))]),_:1})])])])])):F("",!0)])}}}),Tt=le(Pt,[["__scopeId","data-v-54558720"]]),Gt={class:"vocabulary-page"},It={class:"page-content"},Nt={class:"main-content"},qt={key:0,class:"loading-container"},Dt={key:1},Lt={class:"category-section"},Ut={class:"category-header"},jt={class:"category-actions"},Et={class:"category-chips"},Rt={class:"content-header"},Ft={class:"header-actions"},Kt={key:0,class:"vocabularies-list"},Ot={key:2,class:"empty-state"},Qt=oe({__name:"Vocabulary",setup(C){const{t:b}=ye(),z=Ge(),I=ze(),y=_e(),d=c("learn"),P=c("card"),T=c(1),V=c(10),g=c(!1),N=R(()=>z.sections),w=c([]),u=R(()=>z.getVocabulariesBySectionNames(w.value)),h=R(()=>Math.ceil(u.value.length/V.value)),B=R(()=>{const M=(T.value-1)*V.value,v=M+V.value;return u.value.slice(M,v)});function L(){T.value=1}function x(){w.value=[...N.value]}function D(){w.value=[]}function ee(){d.value="dictation"}function q(){d.value="game"}function Q(){d.value="learn"}function te(M){const v=Math.round(M.correct/M.total*100),$=`${b("vocabulary.dictationPractice")} - æ­£ç¡®ç‡: ${v}%`;y.addRecord({type:"vocabulary",title:$,score:v}),d.value="learn"}function W(M){console.log("[Vocabulary] Page changed to:",M),T.value=M}function J(M){return I.isBookmarked("vocabulary",M.åºå·.toString())}function U(M){const v=M.åºå·.toString();I.isBookmarked("vocabulary",v)?I.removeBookmark("vocabulary",v):I.addBookmark("vocabulary",v,M)}return me(async()=>{await z.loadVocabularies(),g.value=!0}),(M,v)=>{const $=A("el-icon"),l=A("el-button"),j=A("el-checkbox-button"),E=A("el-checkbox-group"),X=A("el-button-group"),K=A("el-pagination");return s(),f("div",Gt,[n(Pe),e("div",It,[e("div",Nt,[g.value?(s(),f("div",Dt,[e("div",Lt,[e("div",Ut,[e("h3",null,p(r(b)("vocabulary.selectCategory")),1),e("div",jt,[n(l,{size:"small",link:"",onClick:x},{default:m(()=>[S(p(r(b)("vocabulary.selectAll")),1)]),_:1}),n(l,{size:"small",link:"",onClick:D},{default:m(()=>[S(p(r(b)("vocabulary.clearAll")),1)]),_:1})])]),e("div",Et,[n(E,{modelValue:w.value,"onUpdate:modelValue":v[0]||(v[0]=a=>w.value=a),onChange:L},{default:m(()=>[(s(!0),f(Y,null,Z(N.value,a=>(s(),O(j,{key:a,label:a},{default:m(()=>[S(p(a),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),e("div",Rt,[e("div",Ft,[n(l,{type:d.value==="learn"?"primary":"",onClick:v[1]||(v[1]=a=>d.value="learn")},{default:m(()=>[S(p(r(b)("vocabulary.learnMode")),1)]),_:1},8,["type"]),n(l,{type:d.value==="dictation"?"primary":"",onClick:ee},{default:m(()=>[S(p(r(b)("vocabulary.dictationPractice")),1)]),_:1},8,["type"]),n(l,{type:d.value==="game"?"primary":"",onClick:q},{default:m(()=>[...v[6]||(v[6]=[S(" æ¶ˆé™¤ä¹ ",-1)])]),_:1},8,["type"]),d.value==="learn"?(s(),O(X,{key:0,class:"view-mode-toggle"},{default:m(()=>[n(l,{type:P.value==="card"?"primary":"",icon:r(Be),onClick:v[2]||(v[2]=a=>P.value="card")},{default:m(()=>[S(p(r(b)("vocabulary.cardMode")),1)]),_:1},8,["type","icon"]),n(l,{type:P.value==="list"?"primary":"",icon:r(Me),onClick:v[3]||(v[3]=a=>P.value="list")},{default:m(()=>[S(p(r(b)("vocabulary.listMode")),1)]),_:1},8,["type","icon"])]),_:1})):F("",!0)])]),d.value==="learn"?(s(),f("div",Kt,[P.value==="card"?(s(!0),f(Y,{key:0},Z(B.value,a=>(s(),O(Te,{key:a.åºå·,vocabulary:a,"is-bookmarked":J(a),onBookmark:U},null,8,["vocabulary","is-bookmarked"]))),128)):(s(!0),f(Y,{key:1},Z(B.value,a=>(s(),O(Fe,{key:a.åºå·,vocabulary:a,"is-bookmarked":J(a),onBookmark:U},null,8,["vocabulary","is-bookmarked"]))),128)),u.value.length===0?(s(),f("div",Ot,[n($,{size:48},{default:m(()=>[n(r(xe))]),_:1}),e("p",null,p(r(b)("vocabulary.noCategorySelected")),1)])):F("",!0)])):F("",!0),d.value==="learn"&&h.value>1?(s(),O(K,{key:1,"current-page":T.value,"onUpdate:currentPage":v[4]||(v[4]=a=>T.value=a),"page-size":V.value,total:u.value.length,layout:"prev, pager, next",class:"pagination",onCurrentChange:W},null,8,["current-page","page-size","total"])):d.value==="dictation"?(s(),O(nt,{key:2,vocabularies:u.value,onComplete:te},null,8,["vocabularies"])):d.value==="game"?(s(),O(Tt,{key:3,vocabularies:u.value,onClose:Q},null,8,["vocabularies"])):F("",!0)])):(s(),f("div",qt,[n($,{class:"is-loading",size:32},{default:m(()=>[n(r(Ve))]),_:1}),v[5]||(v[5]=e("p",null,"åŠ è½½ä¸­...",-1))]))])]),n(Ae)])}}}),ta=le(Qt,[["__scopeId","data-v-7ba531ec"]]);export{ta as default};
